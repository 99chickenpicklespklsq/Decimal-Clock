<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>New Time Decimal Clock (Regional)</title>
  
   <!-- PWA / iOS Web Clip Meta Tags -->
   <meta name="apple-mobile-web-app-capable" content="yes">
   <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
   <meta name="apple-mobile-web-app-title" content="New Time Clock">


   <script src="https://cdn.tailwindcss.com"></script>
   <style>
       @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Orbitron:wght@500;700&display=swap');
       body {
           font-family: 'Inter', sans-serif;
           background-color: #0d1117;
           color: #c9d1d9;
           display: flex;
           justify-content: center;
           align-items: center;
           min-height: 100vh;
       }
       .clock-container {
           background: #161b22;
           border: 2px solid #21262d;
           box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5), inset 0 0 10px rgba(71, 160, 255, 0.1);
           max-width: 90%;
           width: 500px;
           padding: 2.5rem 2rem;
           margin: 1rem;
       }
       .new-time-display {
           font-family: 'Orbitron', monospace;
           font-size: 3.5rem;
           letter-spacing: 2px;
           text-shadow: 0 0 10px rgba(71, 160, 255, 0.8);
           color: #47a0ff;
       }
       .old-time-display {
           font-family: 'Orbitron', monospace;
           font-size: 1.5rem;
           color: #8b949e;
       }
       select {
           color: #c9d1d9;
           background-color: #21262d;
           border: 1px solid #30363d;
           padding: 8px 12px;
           border-radius: 6px;
           cursor: pointer;
           transition: border-color 0.15s ease-in-out, background-color 0.15s ease-in-out;
           white-space: nowrap;
       }
       select:focus {
           outline: none;
           border-color: #47a0ff;
           box-shadow: 0 0 0 3px rgba(71, 160, 255, 0.3);
       }


       /* Responsive font size for smaller screens */
       @media (max-width: 640px) {
           .new-time-display {
               font-size: 2.5rem;
           }
           .old-time-display {
               font-size: 1.2rem;
           }
           #timezone-select {
               width: 100%;
           }
       }
   </style>
</head>
<body>


   <div class="clock-container rounded-xl flex flex-col items-center space-y-8">
       <h1 class="text-3xl font-bold text-white mb-2 text-center">Decimal Clock :3</h1>


       <!-- Time Zone Selector -->
       <div class="w-full flex flex-col items-center space-y-4">
           <label for="timezone-select" class="text-sm uppercase text-gray-400">Select Time Zone</label>
           <select id="timezone-select" class="w-full max-w-xs md:max-w-md">
               <!-- Options populated by JavaScript -->
           </select>
       </div>


       <!-- New Time Display -->
       <div class="flex flex-col items-center">
           <p class="text-sm uppercase text-gray-400">Decimal Time: hour = 14.4 minutes, minute = 8.6 seconds, second = 0.86 seconds</p>
           <div id="new-time" class="new-time-display">00.00:0</div>
       </div>


       <!-- Old Time Display -->
       <div class="border-t border-gray-700 w-full pt-4 flex flex-col items-center">
           <p id="old-time-label" class="text-sm uppercase text-gray-400 mb-1">Standard Time</p>
           <div id="old-time" class="old-time-display">00:00:00 [---]</div>
       </div>


       <div id="error-message" class="text-red-500 hidden text-center p-2 rounded"></div>
   </div>


   <script>
       // Constants for conversion (100 NH, 100 NM, 10 NS)
       const TOTAL_NEW_SECONDS_IN_DAY = 100000; // 100 NH * 100 NM * 10 NS
       const TOTAL_OLD_SECONDS_IN_DAY = 86400; // 24 OH * 60 OM * 60 OS


       // Simplified list focused on major US time zones + UTC and key global zones
       const timeZoneOptions = [
           { label: '--- Universal ---', value: 'UTC', default: true },
           { value: 'UTC', label: 'Coordinated Universal Time (UTC)' },
          
           { label: '--- Major US Time Zones ---', value: '', disabled: true },
           { value: 'America/New_York', label: 'Eastern Time (EST/EDT)' },
           { value: 'America/Chicago', label: 'Central Time (CST/CDT)' }, // Central Time
           { value: 'America/Denver', label: 'Mountain Time (MST/MDT)' },
           { value: 'America/Los_Angeles', label: 'Pacific Time (PST/PDT)' }, // Default
          
           { label: '--- Europe & Asia ---', value: '', disabled: true },
           { value: 'Europe/London', label: 'London / GMT/BST' },
           { value: 'Europe/Paris', label: 'Paris / CET/CEST' },
           { value: 'Asia/Tokyo', label: 'Tokyo, Japan (JST)' }, // Added Tokyo
       ];
      
       const selectElement = document.getElementById('timezone-select');


       // --- Initialization: Populate Dropdown ---
       timeZoneOptions.forEach(option => {
           const opt = document.createElement('option');
           opt.value = option.value;
           opt.textContent = option.label;
          
           if (option.disabled) {
               opt.disabled = true;
               opt.style.fontWeight = 'bold';
               opt.style.color = '#8b949e';
           }
           if (option.value === 'America/Los_Angeles') {
                opt.selected = true; // Set default selection
           }
          
           selectElement.appendChild(opt);
       });
      
       // Add event listener to update the clock immediately when a new zone is selected
       selectElement.addEventListener('change', updateClock);


       // --- Helper Function to Get Time in Specific Time Zone ---
       function getTimeComponents(timeZone) {
           const date = new Date();
           let h, m, s, zone;


           try {
               // Get the current time components and the current zone abbreviation
               // This uses the browser's Intl API to automatically handle DST for the selected time zone.
               const formatter = new Intl.DateTimeFormat('en-US', {
                   hour: 'numeric', minute: 'numeric', second: 'numeric',
                   hourCycle: 'h23', timeZone: timeZone, timeZoneName: 'short'
               });
               const parts = formatter.formatToParts(date);
              
               // Use a cleaner approach to find and parse hour, minute, second
               const findPart = (type) => parseInt(parts.find(p => p.type === type)?.value || '0', 10);
              
               h = findPart('hour');
               m = findPart('minute');
               s = findPart('second');


               const zoneFormatter = new Intl.DateTimeFormat('en-US', { timeZoneName: 'short', timeZone: timeZone });
               const zoneMatch = zoneFormatter.format(date).match(/[A-Z]+$/);
               zone = zoneMatch ? zoneMatch[0] : timeZone.replace(/.*\//, '');


           } catch (error) {
               console.error("Error fetching time components for zone:", timeZone, error);
               document.getElementById('error-message').textContent = `Error fetching time for ${timeZone}. Using local time as fallback.`;
               document.getElementById('error-message').classList.remove('hidden');
              
               // Fallback to local time
               h = date.getHours();
               m = date.getMinutes();
               s = date.getSeconds();
               zone = 'Local Time';
           }


           return { h, m, s, zone };
       }


       // --- Core Conversion Function (FIXED FOR ROUNDING ISSUE) ---
       function convertToNewTime({ h, m, s }) {
           // 1. Calculate total elapsed seconds in Old Time since midnight
           const oldSecondsElapsed = (h * 3600) + (m * 60) + s;


           // 2. Calculate the ratio of the day completed (0.0 to 1.0)
           const ratio = oldSecondsElapsed / TOTAL_OLD_SECONDS_IN_DAY;


           // 3. Calculate the total New Seconds elapsed (0 to 99999)
           const newSecondsFloat = ratio * TOTAL_NEW_SECONDS_IN_DAY;


           // FIX: Use Math.round() for better precision handling in the conversion,
           // and cap the maximum value to prevent rollover errors.
           let totalNewSecondsInt = Math.round(newSecondsFloat);


           // Ensure the value never exceeds the maximum possible count (99999)
           if (totalNewSecondsInt >= TOTAL_NEW_SECONDS_IN_DAY) {
               totalNewSecondsInt = 0; // It's midnight, reset to 0
           }




           // 4. Deconstruct the total New Seconds into NH, NM, and NS
           const NH = Math.floor(totalNewSecondsInt / 1000); // New Hour (1 NH = 1000 NS)
           const remainingNewSeconds = totalNewSecondsInt % 1000;
           const NM = Math.floor(remainingNewSeconds / 10); // New Minute (1 NM = 10 NS)
           const NS = remainingNewSeconds % 10; // New Second (0 to 9)


           // The NH rollover check is now handled implicitly by the totalNewSecondsInt check above.
          
           // Format NH and NM to be zero-padded
           const formattedNH = String(NH).padStart(2, '0');
           const formattedNM = String(NM).padStart(2, '0');
          
           const newTimeStr = `${formattedNH}.${formattedNM}:${NS}`;


           return newTimeStr;
       }


       // --- Update Display Function ---
       function updateClock() {
           // Get the selected time zone
           const selectedTimeZone = selectElement.value;


           // Guard against selecting a disabled header option
           if (!selectedTimeZone) return;


           // Get time components for the selected zone
           const timeComponents = getTimeComponents(selectedTimeZone);


           if (!timeComponents) {
               return;
           }


           const { h, m, s, zone } = timeComponents;


           // Format Old Time
           const formattedH = String(h).padStart(2, '0');
           const formattedM = String(m).padStart(2, '0');
           const formattedS = String(s).padStart(2, '0');
           document.getElementById('old-time').textContent = `${formattedH}:${formattedM}:${formattedS} [${zone}]`;


           // Update the standard time label to be more descriptive
           const labelText = timeZoneOptions.find(opt => opt.value === selectedTimeZone)?.label || 'Standard Time';
           document.getElementById('old-time-label').textContent = `${labelText} Standard Time`;


           // Convert and display New Time
           const newTimeStr = convertToNewTime(timeComponents);
           document.getElementById('new-time').textContent = newTimeStr;
       }


       // Initial setup and start clock
       updateClock();
       // We use a high update rate (100ms) to ensure we hit the 0.864s cycle smoothly
       const clockInterval = setInterval(updateClock, 100);


   </script>
</body>
</html>